<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Lin">





<title>redis01：基本命令 | 12wj</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.1.1"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Lin&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Lin&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">redis01：基本命令</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Lin</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">March 11, 2024&nbsp;&nbsp;23:24:19</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/Redis/">Redis</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <blockquote>
<p>该文章用于记录redis常用命令</p>
<ul>
<li>图文教程：<ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/redis-tutorial.html">Redis 教程 | 菜鸟教程 (runoob.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://xiaolincoding.com/redis/">图解Redis介绍 | 小林coding (xiaolincoding.com)</a></li>
</ul>
</li>
<li>视频教程：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Jj411D7oG?p=1&vd_source=944660b6aa35e4af209354e2642f7694">01.课程简介_哔哩哔哩_bilibili</a></li>
</ul>
</blockquote>
<br>

<h1 id="1-Redis-基本数据类型"><a href="#1-Redis-基本数据类型" class="headerlink" title="1.Redis 基本数据类型"></a>1.Redis 基本数据类型</h1><p><code>Redis</code>支持五种数据类型：<code>string（字符串）</code>，<code>hash（哈希）</code>，<code>list（列表）</code>，<code>set（集合）</code>及<code>zset(sorted set：有序集合)</code>。</p>
<hr>

<h2 id="1-string"><a href="#1-string" class="headerlink" title="1.string"></a>1.string</h2><ul>
<li>string类型，即一个<code>key</code>对应一个<code>value</code></li>
</ul>
<h5 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h5><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; <span class="built_in">set</span> name linnxy </span><br><span class="line">OK</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; get name</span><br><span class="line">&quot;linnxy&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; <span class="built_in">append</span> name hi  # 在value后追加hi</span><br><span class="line">(integer) <span class="number">8</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; get name</span><br><span class="line">&quot;linnxyhi&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; strlen name		# 获取value长度</span><br><span class="line">(integer) <span class="number">8</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; setex age <span class="number">20</span> <span class="number">20</span>  # 设置age的过期时间<span class="number">20</span>s</span><br><span class="line">OK</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; ttl age		# ttl查看age的过期时间</span><br><span class="line">(integer) <span class="number">16</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; get age</span><br><span class="line">&quot;<span class="number">20</span>&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; ttl age</span><br><span class="line">(integer) <span class="number">8</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：一个键最大能存储512MB</p>
<br>

<br>

<h2 id="2-Hash"><a href="#2-Hash" class="headerlink" title="2.Hash"></a>2.Hash</h2><ul>
<li><code>Redis hash</code> 是一个 <code>string</code> 类型的<code> field</code> 和 <code>value</code> 的映射表，简单来说就是键值对的集合，<code>hash</code> 特别适合用于存储对象。</li>
<li><code>hash</code>的命令都以<code>h</code>开头</li>
</ul>
<h5 id="示例：-1"><a href="#示例：-1" class="headerlink" title="示例："></a>示例：</h5><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># hset key field value</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; hset person name linnxy # hset设置哈希中的键值对</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; hset person age <span class="number">20</span></span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; hset person indentity student</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; hgetall person  # hgetall 查看person的所有键值对</span><br><span class="line"><span class="number">1</span>) &quot;name&quot;</span><br><span class="line"><span class="number">2</span>) &quot;linnxy&quot;</span><br><span class="line"><span class="number">3</span>) &quot;age&quot;</span><br><span class="line"><span class="number">4</span>) &quot;<span class="number">20</span>&quot;</span><br><span class="line"><span class="number">5</span>) &quot;indentity&quot;</span><br><span class="line"><span class="number">6</span>) &quot;student&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; hget person age # 获取person中的age键值</span><br><span class="line">&quot;<span class="number">20</span>&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; hdel person age	# 删除age键</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; hexists person age	# hexists 判断某个键是否存在</span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; hkeys person	# hkeys获取该person的所有键</span><br><span class="line"><span class="number">1</span>) &quot;name&quot;</span><br><span class="line"><span class="number">2</span>) &quot;indentity&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; hlen person		# hlen 获取该哈希表的键数量</span><br><span class="line">(integer) <span class="number">2</span></span><br></pre></td></tr></table></figure>

<br>

<br>

<h2 id="3-List"><a href="#3-List" class="headerlink" title="3. List"></a>3. List</h2><blockquote>
<p>可以用于实现消息队列，<strong>生产消费</strong>关系</p>
</blockquote>
<ul>
<li><code>Redis</code> 列表是简单的字符串列表，按照<strong>插入顺序</strong>排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）。</li>
</ul>
<h5 id="示例：-2"><a href="#示例：-2" class="headerlink" title="示例："></a>示例：</h5><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; lpush array java	# lpush 将value添加到array的左边</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; lpush array c++		 </span><br><span class="line">(integer) <span class="number">2</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; lpush array python</span><br><span class="line">(integer) <span class="number">3</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; lrange array <span class="number">0</span> -<span class="number">1</span>	# 获取array列表指定范围的元素，<span class="number">0</span>，-<span class="number">1</span>表示从开始到结束</span><br><span class="line"><span class="number">1</span>) &quot;python&quot;</span><br><span class="line"><span class="number">2</span>) &quot;c++&quot;</span><br><span class="line"><span class="number">3</span>) &quot;java&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; llen array		# llen获取列表长度</span><br><span class="line">(integer) <span class="number">3</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; rpush array go		# 从array右边插入元素</span><br><span class="line">(integer) <span class="number">4</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; rpop array	# 从右边弹出一个元素</span><br><span class="line">&quot;go&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; lpop array	# 从左边弹出一个元素</span><br><span class="line">&quot;python&quot;</span><br></pre></td></tr></table></figure>

<br>

<br>

<h2 id="4-set："><a href="#4-set：" class="headerlink" title="4. set："></a>4. set：</h2><ul>
<li>Redis的<code>Set</code>是string类型的无序集合。<strong>集合成员是唯一的</strong>，这就意味着集合中<strong>不能出现重复的数据</strong>。</li>
<li>set集合命令都以<code>s</code>开头</li>
</ul>
<h5 id="示例：-3"><a href="#示例：-3" class="headerlink" title="示例："></a>示例：</h5><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; sadd course redis	# sadd：course中添加redis</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; smembers course		# smembers：查看course中所有元素</span><br><span class="line"><span class="number">1</span>) &quot;redis&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; sadd course redis	# <span class="built_in">set</span>不能添加重复元素，返回<span class="number">0</span></span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; sismember course redis	# sismember判断某个元素是否在集合中</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; sismember course python</span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; srem course redis	# srem移除某个元素</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; smembers course</span><br><span class="line">(empty list or <span class="built_in">set</span>)</span><br></pre></td></tr></table></figure>

<br>

<br>

<h2 id="5-sorted-set-有序集合-："><a href="#5-sorted-set-有序集合-：" class="headerlink" title="5. sorted set(有序集合)："></a>5. sorted set(有序集合)：</h2><ul>
<li><strong>有序集合</strong>和集合一样也是string类型元素的集合，且不允许重复的成员</li>
<li>不同的是<strong>每个元素都会关联一个double类型的分数<code>sorce</code><strong>。redis正是</strong>通过分数来为集合中的成员进行从小到大的排序</strong>。</li>
<li>sorted set有序集合的命令以<code>z</code>开头</li>
</ul>
<h5 id="示例：-4"><a href="#示例：-4" class="headerlink" title="示例："></a>示例：</h5><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; zadd university <span class="number">680</span> qinghua <span class="number">660</span> beida <span class="number">650</span> fudan <span class="number">640</span> zheda  # zadd添加元素</span><br><span class="line">(integer) <span class="number">4</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; zrange university <span class="number">0</span> -<span class="number">1</span>	# zrange 查看university中元素</span><br><span class="line"><span class="number">1</span>) &quot;zheda&quot;</span><br><span class="line"><span class="number">2</span>) &quot;fudan&quot;</span><br><span class="line"><span class="number">3</span>) &quot;beida&quot;</span><br><span class="line"><span class="number">4</span>) &quot;qinghua&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; zrange university <span class="number">0</span> -<span class="number">1</span> withscores	# withscores同时查看分数</span><br><span class="line"><span class="number">1</span>) &quot;zheda&quot;</span><br><span class="line"><span class="number">2</span>) &quot;<span class="number">640</span>&quot;</span><br><span class="line"><span class="number">3</span>) &quot;fudan&quot;</span><br><span class="line"><span class="number">4</span>) &quot;<span class="number">650</span>&quot;</span><br><span class="line"><span class="number">5</span>) &quot;beida&quot;</span><br><span class="line"><span class="number">6</span>) &quot;<span class="number">660</span>&quot;</span><br><span class="line"><span class="number">7</span>) &quot;qinghua&quot;</span><br><span class="line"><span class="number">8</span>) &quot;<span class="number">680</span>&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; zscore university qinghua	# zscore 查看某个元素的scores</span><br><span class="line">&quot;<span class="number">680</span>&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; zrank university qinghua	# zrank 查看某个元素的排名，默认升序</span><br><span class="line">(integer) <span class="number">3</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; zrevrank university qinghua	# zrevrank 查看某个元素的降序排名</span><br><span class="line">(integer) <span class="number">0</span></span><br></pre></td></tr></table></figure>

<br>

<br>

<br>

<h1 id="2-Redis-HyperLogLog"><a href="#2-Redis-HyperLogLog" class="headerlink" title="2. Redis HyperLogLog"></a>2. Redis HyperLogLog</h1><ul>
<li>Redis <strong>HyperLogLog</strong> 是用来做<strong>基数统计</strong>的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定 的、并且是很小的。</li>
<li>注意：<strong>HyperLogLog</strong> 只会<u>根据输入元素来计算基数</u>，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。</li>
<li><strong>应用场景</strong>：<ul>
<li>统计某个词的搜索次数……</li>
<li>统计页面<code>UV</code></li>
</ul>
</li>
<li><strong>HyperLogLog</strong>的命令都以<code>pf</code>开头</li>
</ul>
<h5 id="示例：-5"><a href="#示例：-5" class="headerlink" title="示例："></a>示例：</h5><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; pfadd search abc	# pfabc添加abc</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; pfadd search hhh</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; pfcount search	# pfcount查看基数</span><br><span class="line">(integer) <span class="number">2</span></span><br></pre></td></tr></table></figure>

<br>

<br>

<br>

<h1 id="3-Redis：发布订阅模式"><a href="#3-Redis：发布订阅模式" class="headerlink" title="3. Redis：发布订阅模式"></a>3. Redis：发布订阅模式</h1><ul>
<li><p>Redis 发布订阅**(pub&#x2F;sub)**是一种消息通信模式：发送者(pub)发送消息，订阅者(sub)接收消息。</p>
</li>
<li><p>Redis 客户端可以订阅任意数量的频道。</p>
<br>
</li>
<li><p>发布&#x2F;订阅过程如下：</p>
<p><img src="https://pic.imgdb.cn/item/65efd14f9f345e8d03d633b2.jpg" style="zoom:80%;" /> <img src="https://pic.imgdb.cn/item/65efd18d9f345e8d03d749f8.jpg" style="zoom: 80%;" />  </p>
<ul>
<li>终端1、2、3……订阅频道  &#x3D;&gt; <code>subscribe</code></li>
<li>终端4在该频道发布消息  &#x3D;&gt; <code>publish</code></li>
</ul>
</li>
</ul>
<br>

<h5 id="示例：-6"><a href="#示例：-6" class="headerlink" title="示例："></a>示例：</h5><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 终端<span class="number">1</span>订阅频道</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; subscribe redischat</span><br><span class="line">Reading messages... (press Ctrl-C to quit)</span><br><span class="line"><span class="number">1</span>) &quot;subscribe&quot;</span><br><span class="line"><span class="number">2</span>) &quot;redischat&quot;</span><br><span class="line"><span class="number">3</span>) (integer) <span class="number">1</span></span><br><span class="line"></span><br><span class="line"># 终端<span class="number">2</span>发布消息</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; publish redischat &quot;hello&quot;</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; publish redischat &quot;hey&quot;</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"></span><br><span class="line"># 此时终端<span class="number">1</span>接受到了消息</span><br><span class="line"><span class="number">1</span>) &quot;message&quot;</span><br><span class="line"><span class="number">2</span>) &quot;redischat&quot;</span><br><span class="line"><span class="number">3</span>) &quot;hello&quot;</span><br><span class="line"><span class="number">1</span>) &quot;message&quot;</span><br><span class="line"><span class="number">2</span>) &quot;redischat&quot;</span><br><span class="line"><span class="number">3</span>) &quot;hey&quot;</span><br></pre></td></tr></table></figure>

<br>

<ul>
<li>发布订阅的<strong>缺点</strong>：<ul>
<li>消息无法持久化</li>
<li>无法保存历史纪录</li>
</ul>
</li>
</ul>
<br>

<br>

<br>

<h1 id="4-Redis：消息队列Stream"><a href="#4-Redis：消息队列Stream" class="headerlink" title="4.Redis：消息队列Stream"></a>4.Redis：消息队列Stream</h1><ul>
<li>stream命令都以<code>x</code>开头</li>
<li>在<strong>消息队列</strong>中的使用：<ul>
<li>生产者使用<code>xadd</code>生产消息</li>
<li>消费者使用<code>xread</code>消费消息</li>
</ul>
</li>
</ul>
<img src="https://pic.imgdb.cn/item/65efebf09f345e8d03517d8b.jpg" style="zoom:80%;" /> 

<h4 id="4-1-xadd-生产消息"><a href="#4-1-xadd-生产消息" class="headerlink" title="4.1 xadd 生产消息"></a>4.1 xadd 生产消息</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xadd key ID field string [field string ...]</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>key</strong> ：队列名称，如果不存在就创建</p>
</li>
<li><p><strong>ID</strong> ：消息 id，我们使用 <code>*</code> 表示由 redis 生成，可以自定义，但是要自己保证<strong>递增性</strong>。</p>
</li>
<li><p><strong>field value</strong> ： 记录。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xadd msglist * msg one</span><br><span class="line">&quot;<span class="number">1710220856078</span>-<span class="number">0</span>&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xadd msglist * msg two</span><br><span class="line">&quot;<span class="number">1710220862483</span>-<span class="number">0</span>&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xadd msglist * msg three</span><br><span class="line">&quot;<span class="number">1710220868470</span>-<span class="number">0</span>&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xrange msglist - +	 # xrange获取消息队列 -最小值 +最大值</span><br><span class="line"><span class="number">1</span>) <span class="number">1</span>) &quot;<span class="number">1710220856078</span>-<span class="number">0</span>&quot;</span><br><span class="line">   <span class="number">2</span>) <span class="number">1</span>) &quot;msg&quot;</span><br><span class="line">      <span class="number">2</span>) &quot;one&quot;</span><br><span class="line"><span class="number">2</span>) <span class="number">1</span>) &quot;<span class="number">1710220862483</span>-<span class="number">0</span>&quot;</span><br><span class="line">   <span class="number">2</span>) <span class="number">1</span>) &quot;msg&quot;</span><br><span class="line">      <span class="number">2</span>) &quot;two&quot;</span><br><span class="line"><span class="number">3</span>) <span class="number">1</span>) &quot;<span class="number">1710220868470</span>-<span class="number">0</span>&quot;</span><br><span class="line">   <span class="number">2</span>) <span class="number">1</span>) &quot;msg&quot;</span><br><span class="line">      <span class="number">2</span>) &quot;three&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xdel msglist  <span class="number">1710220856078</span>-<span class="number">0</span>	# 根据id删除消息</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xrange msglist - +</span><br><span class="line"><span class="number">1</span>) <span class="number">1</span>) &quot;<span class="number">1710220862483</span>-<span class="number">0</span>&quot;</span><br><span class="line">   <span class="number">2</span>) <span class="number">1</span>) &quot;msg&quot;</span><br><span class="line">      <span class="number">2</span>) &quot;two&quot;</span><br><span class="line"><span class="number">2</span>) <span class="number">1</span>) &quot;<span class="number">1710220868470</span>-<span class="number">0</span>&quot;</span><br><span class="line">   <span class="number">2</span>) <span class="number">1</span>) &quot;msg&quot;</span><br><span class="line">      <span class="number">2</span>) &quot;three&quot;</span><br></pre></td></tr></table></figure></li>
</ul>
<br>

<h4 id="4-2-xread-读取消息"><a href="#4-2-xread-读取消息" class="headerlink" title="4.2 xread 读取消息"></a>4.2 xread 读取消息</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xread [COUNT count] [BLOCK milliseconds] STREAMS key [key ...] ID [ID ...]</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>count</strong> ：读取数量</p>
</li>
<li><p><strong>milliseconds</strong> ：可选，阻塞毫秒数，没有设置就是非阻塞模式</p>
</li>
<li><p><strong>key</strong> ：队列名</p>
</li>
<li><p><strong>id</strong> ：消息 ID（从这个id开始读取之后的消息</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xread count <span class="number">1</span> block <span class="number">1000</span> streams msglist <span class="number">1710220862483</span>-<span class="number">0</span></span><br><span class="line"><span class="number">1</span>) <span class="number">1</span>) &quot;msglist&quot;</span><br><span class="line">   <span class="number">2</span>) <span class="number">1</span>) <span class="number">1</span>) &quot;<span class="number">1710220868470</span>-<span class="number">0</span>&quot;</span><br><span class="line">         <span class="number">2</span>) <span class="number">1</span>) &quot;msg&quot;</span><br><span class="line">            <span class="number">2</span>) &quot;three&quot;</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt;             </span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="4-3-xgroup-create-创建消费者组"><a href="#4-3-xgroup-create-创建消费者组" class="headerlink" title="4.3 xgroup create 创建消费者组"></a>4.3 xgroup create 创建消费者组</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xgroup create [CREATE key groupname id-or-$]</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>key</strong> ：消息队列的名称，如果不存在就创建</p>
</li>
<li><p><strong>groupname</strong> ：创建的组名。</p>
</li>
<li><p><strong>id &#x2F; $</strong> ：</p>
<ul>
<li><code> id</code>表示消息的id，表示从该id之后消费消息</li>
<li><code>$</code>表示从<strong>尾部开始消费，只接受新消息</strong>，当前 Stream 消息会全部忽略。</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; xgroup create msglist group2 <span class="number">1710220862483</span>-<span class="number">0</span></span><br><span class="line">OK</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt;</span><br></pre></td></tr></table></figure>

<br></li>
</ul>
<h4 id="4-4-xgroup-createconsumer-在消费者组中创建消费者"><a href="#4-4-xgroup-createconsumer-在消费者组中创建消费者" class="headerlink" title="4.4 xgroup createconsumer 在消费者组中创建消费者"></a>4.4 xgroup createconsumer 在消费者组中创建消费者</h4><h4 id="4-5-xreadgroup-group-读取消息"><a href="#4-5-xreadgroup-group-读取消息" class="headerlink" title="4.5 xreadgroup group 读取消息"></a>4.5 xreadgroup group 读取消息</h4><br>

<h1 id="5-Redis：事务"><a href="#5-Redis：事务" class="headerlink" title="5. Redis：事务"></a>5. Redis：事务</h1><blockquote>
<p>redis的事务并不具备原子性的机制，可以理解为一个打包的批量执行脚本</p>
</blockquote>
<p>Redis 事务可以一次执行多个命令， 并且带有以下三个重要的保证：</p>
<ul>
<li><p><strong>批量操作</strong>在<strong>发送 EXEC 命令前被放入队列缓存</strong>。</p>
</li>
<li><p>收到 EXEC 命令后进入事务执行，事务<strong>中任意命令执行失败，其余的命令依然被执行</strong>。</p>
</li>
<li><p>在事务执行过程，其他客户端提交的命令请求不会插入到事务执行命令序列中。</p>
</li>
</ul>
<p>一个事务从开始到执行会经历以下三个阶段：</p>
<ul>
<li>开始事务。</li>
<li>命令入队。</li>
<li>执行事务。</li>
</ul>
<h5 id="示例：-7"><a href="#示例：-7" class="headerlink" title="示例："></a>示例：</h5><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; multi</span><br><span class="line">OK</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; <span class="built_in">set</span> k1 <span class="number">1</span></span><br><span class="line">QUEUED</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">QUEUED</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; <span class="built_in">set</span> k3 <span class="number">3</span></span><br><span class="line">QUEUED</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; exec</span><br><span class="line"><span class="number">1</span>) OK</span><br><span class="line"><span class="number">2</span>) OK</span><br><span class="line"><span class="number">3</span>) OK</span><br><span class="line"></span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; multi</span><br><span class="line">OK</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; incr k1</span><br><span class="line">QUEUED</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; incr k2</span><br><span class="line">QUEUED</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; incr k3</span><br><span class="line">QUEUED</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">6379</span>&gt; exec</span><br><span class="line"><span class="number">1</span>) (integer) <span class="number">2</span></span><br><span class="line"><span class="number">2</span>) (error) ERR value is <span class="keyword">not</span> an integer or out of range	# 该操作执行失败</span><br><span class="line"><span class="number">3</span>) (integer) <span class="number">4</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="6-Redis：持久化"><a href="#6-Redis：持久化" class="headerlink" title="6. Redis：持久化"></a>6. Redis：持久化</h1><blockquote>
</blockquote>
<ul>
<li>RDB</li>
<li>AOP</li>
</ul>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Lin</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://12wj.github.io/2024/03/11/redis01%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/">https://12wj.github.io/2024/03/11/redis01%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2024/03/12/spring/">Mybatis</a>
            
            
            <a class="next" rel="next" href="/2024/03/11/25-k%E4%B8%AA%E4%B8%80%E7%BB%84%E7%BF%BB%E8%BD%AC%E9%93%BE%E8%A1%A8/">25.k个一组翻转链表</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Lin | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>